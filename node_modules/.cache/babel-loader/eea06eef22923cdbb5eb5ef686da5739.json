{"ast":null,"code":"var _jsxFileName = \"/Users/ameesankhesara/Desktop/CourseWork/Spring-2020/StockDash/src/SearchBar.js\";\nimport React, { Component } from \"react\";\nimport \"./SearchBar.css\";\nimport { loadLatestQuote, getCompanyProfile, logo, symbols_company, sector_perf, getFullHistoricalData, getHourlyPrice, getFiveDaysPrice } from \"./RestApiCalls\";\nimport constructLatestQuote from \"./ConstructLatestQuote\";\nimport LoadLatestQuote from \"./LoadLatestQuote\";\nimport LoadCompanyProfile from \"./LoadCompanyProfile\";\nimport SectorPerformance from \"./SectorPerformance\";\nimport StockChartBar from \"./StockChartBar\";\nimport LoadStockTable from \"./LoadStockTable\"; //Search Bar (AutoComplete Textbox) with all results.\n\nclass SearchBar extends Component {\n  constructor(property) {\n    super(property);\n\n    this.onCompanyNameChange = e => {\n      const value = e.target.value;\n\n      if (value.length === 0) {\n        this.setState({\n          text: ''\n        });\n        this.setState({\n          suggestions: []\n        });\n        this.setState({\n          companyName: ''\n        }, this.getStock_MainFunction);\n      }\n\n      let suggest = [];\n\n      if (value.length > 0) {\n        const regex = new RegExp(`^${value}`, 'i');\n        suggest = this.state.companyNamesFromJSON.sort().filter(v => regex.test(v));\n      }\n\n      this.setState({\n        suggestions: suggest,\n        text: value\n      });\n    };\n\n    this.state = {\n      suggestions: [],\n      text: '',\n      companyNamesFromJSON: [],\n      company_symbol_json: [],\n      latestQuote: null,\n      companyName: \"\",\n      logo_img: null,\n      quote: null,\n      companyprofile: null,\n      sector_data: null,\n      stockPrice: [],\n      series: [{\n        data: []\n      }],\n      fiveDayPrice: []\n    };\n    this.symbol = {\n      value: \"\"\n    };\n    this.getStock_MainFunction = this.getStock_MainFunction.bind(this);\n    this.onCompanyNameChange = this.onCompanyNameChange.bind(this);\n    this.calculateSuggestions = this.calculateSuggestions.bind(this);\n    this.suggestionsSelected = this.suggestionsSelected.bind(this);\n    this.getCompanyNamesForSuggestion = this.getCompanyNamesForSuggestion.bind(this);\n  } //On Detecting change in textbox value, populate the company name suggestions\n  //If text is empty, reset the states.\n\n\n  //On selecting the company name from the drop down, call the main function: Get Stock\n  suggestionsSelected(value) {\n    this.setState({\n      text: value\n    });\n    this.setState({\n      suggestions: []\n    });\n    this.setState({\n      companyName: value\n    }, this.getStock_MainFunction);\n  } //Renders company name suggestions in a list\n\n\n  calculateSuggestions() {\n    const {\n      suggestions\n    } = this.state;\n\n    if (suggestions.length === 0) {\n      return null;\n    }\n\n    var i = 0;\n    return /*#__PURE__*/React.createElement(\"section\", {\n      role: \"list\",\n      className: \"list-wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 17\n      }\n    }, suggestions.map(item => /*#__PURE__*/React.createElement(\"div\", {\n      role: \"listitem\",\n      className: \"list-item\",\n      key: i++,\n      onClick: () => this.suggestionsSelected(item),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 40\n      }\n    }, item)));\n  } //Given the company name, find the symbol to use in subsequent requests\n\n\n  getSymbolFromCompanyName(companyName) {\n    for (var i = 0; i < this.state.company_symbol_json.length; i++) {\n      if (this.state.company_symbol_json[i].name.toLowerCase().includes(companyName.toLowerCase())) {\n        this.symbol.value = this.state.company_symbol_json[i].symbol;\n        return;\n      }\n    }\n  } //Main Function: Get response from all APIS: Latest Quote, Company Profile, Logo\n\n\n  getStock_MainFunction() {\n    if (this.state.companyName === undefined || this.state.companyName.length === 0) {\n      this.setState({\n        latestQuote: null\n      });\n      this.setState({\n        logo_img: null\n      });\n      this.setState({\n        quote: null\n      });\n      this.setState({\n        companyprofile: null\n      });\n      this.setState({\n        stockPrice: null\n      });\n      this.setState({\n        fiveDayPrice: null\n      });\n    } else {\n      this.getSymbolFromCompanyName(this.state.companyName);\n      Promise.all([loadLatestQuote(this.symbol.value), getCompanyProfile(this.symbol.value), logo(this.symbol.value), getFullHistoricalData(this.symbol.value), getFiveDaysPrice(this.symbol.value)]).then(values => {\n        let quote_data = values[0];\n        this.setState({\n          latestQuote: constructLatestQuote(quote_data)\n        });\n        this.setState({\n          logo_img: values[2]\n        });\n        let quote_temp = { ...this.state.latestQuote,\n          logo_img: this.state.logo_img\n        };\n        this.setState({\n          quote: quote_temp\n        });\n        this.setState({\n          companyprofile: values[1]['profile']\n        });\n        this.setState({\n          stockPrice: values[3]['historical']\n        });\n        this.setState({\n          fiveDayPrice: values[4]\n        });\n        var date = new Date();\n        var startdate = new Date(date.setMonth(date.getMonth() - 1));\n        var oneMonthdata = values[3]['historical'].filter(function (obj) {\n          var temp = new Date(obj.date);\n          return temp >= startdate;\n        });\n        this.setState({\n          oneMonthPrice: oneMonthdata\n        });\n        var stockdata = [];\n        oneMonthdata.map(item => {\n          var stockdataArr = [];\n          stockdataArr.push(item.date, item.open, item.high, item.low, item.close);\n          stockdata.push(stockdataArr);\n        });\n        this.setState({\n          series: [{\n            data: stockdata\n          }]\n        });\n      });\n    }\n  } //Populate all the company Names to use for suggestions later\n\n\n  getCompanyNamesForSuggestion() {\n    var data = [];\n\n    for (var i = 0; i < this.state.company_symbol_json.length; i++) {\n      if (this.state.company_symbol_json[i].name.length !== 0) {\n        data.push(this.state.company_symbol_json[i].name);\n      }\n    }\n\n    this.setState({\n      companyNamesFromJSON: data\n    });\n  } //Executed on load: Symbols and Company mapping data, Sector Performance\n\n\n  async componentDidMount() {\n    Promise.all([symbols_company(), sector_perf()]).then(values => {\n      this.setState({\n        company_symbol_json: values[0]\n      }, this.getCompanyNamesForSuggestion);\n      let data_temp = {};\n      data_temp = {\n        basicMaterials: values[1]['sectorPerformance'][0].changesPercentage,\n        CommunicationServices: values[1]['sectorPerformance'][1].changesPercentage,\n        Conglomerates: values[1]['sectorPerformance'][2].changesPercentage,\n        ConsumerCyclical: values[1]['sectorPerformance'][3].changesPercentage,\n        ConsumerDefensive: values[1]['sectorPerformance'][4].changesPercentage,\n        Energy: values[1]['sectorPerformance'][5].changesPercentage,\n        Financial: values[1]['sectorPerformance'][6].changesPercentage,\n        FinancialServices: values[1]['sectorPerformance'][7].changesPercentage,\n        Healthcare: values[1]['sectorPerformance'][8].changesPercentage,\n        IndustrialGoods: values[1]['sectorPerformance'][9].changesPercentage,\n        Industrials: values[1]['sectorPerformance'][10].changesPercentage,\n        RealEstate: values[1]['sectorPerformance'][11].changesPercentage,\n        Services: values[1]['sectorPerformance'][12].changesPercentage,\n        Technology: values[1]['sectorPerformance'][13].changesPercentage,\n        Utilities: values[1]['sectorPerformance'][14].changesPercentage\n      };\n      this.setState({\n        sector_data: data_temp\n      });\n    });\n  }\n\n  render() {\n    const {\n      text\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      role: \"main\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"AutoComplete\",\n      role: \"search\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      value: text,\n      placeholder: \"Enter name of organization\",\n      onChange: this.onCompanyNameChange,\n      type: \"text\",\n      \"aria-label\": \"Select company name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 21\n      }\n    }), this.calculateSuggestions()), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"block_latestquote\",\n      role: \"contentinfo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 17\n      }\n    }, this.state.quote == null ? this.state.sector_data == null ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"null_condition\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 83\n      }\n    }) : /*#__PURE__*/React.createElement(SectorPerformance, Object.assign({}, this.state.sector_data, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 125\n      }\n    })) : /*#__PURE__*/React.createElement(LoadLatestQuote, Object.assign({}, this.state.quote, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 177\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"block_latestquote\",\n      role: \"contentinfo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 17\n      }\n    }, this.state.companyprofile == null ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"null_condition\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 58\n      }\n    }) : /*#__PURE__*/React.createElement(LoadCompanyProfile, Object.assign({}, this.state.companyprofile, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 99\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 17\n      }\n    }, this.state.stockPrice.length == 0 ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"null_condition\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 58\n      }\n    }) : /*#__PURE__*/React.createElement(StockChartBar, {\n      stockprice: this.state.stockPrice,\n      series: this.state.series,\n      fiveDayPrice: this.state.fiveDayPrice,\n      oneMonthPrice: this.state.oneMonthPrice,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 17\n      }\n    }, this.state.stockPrice.length == 0 ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"null_condition\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 54\n      }\n    }) : /*#__PURE__*/React.createElement(LoadStockTable, {\n      stockprice: this.state.stockPrice,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 95\n      }\n    })));\n  }\n\n}\n\nexport default SearchBar;","map":{"version":3,"sources":["/Users/ameesankhesara/Desktop/CourseWork/Spring-2020/StockDash/src/SearchBar.js"],"names":["React","Component","loadLatestQuote","getCompanyProfile","logo","symbols_company","sector_perf","getFullHistoricalData","getHourlyPrice","getFiveDaysPrice","constructLatestQuote","LoadLatestQuote","LoadCompanyProfile","SectorPerformance","StockChartBar","LoadStockTable","SearchBar","constructor","property","onCompanyNameChange","e","value","target","length","setState","text","suggestions","companyName","getStock_MainFunction","suggest","regex","RegExp","state","companyNamesFromJSON","sort","filter","v","test","company_symbol_json","latestQuote","logo_img","quote","companyprofile","sector_data","stockPrice","series","data","fiveDayPrice","symbol","bind","calculateSuggestions","suggestionsSelected","getCompanyNamesForSuggestion","i","map","item","getSymbolFromCompanyName","name","toLowerCase","includes","undefined","Promise","all","then","values","quote_data","quote_temp","date","Date","startdate","setMonth","getMonth","oneMonthdata","obj","temp","oneMonthPrice","stockdata","stockdataArr","push","open","high","low","close","componentDidMount","data_temp","basicMaterials","changesPercentage","CommunicationServices","Conglomerates","ConsumerCyclical","ConsumerDefensive","Energy","Financial","FinancialServices","Healthcare","IndustrialGoods","Industrials","RealEstate","Services","Technology","Utilities","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./SearchBar.css\";\nimport { loadLatestQuote, getCompanyProfile, logo, symbols_company, sector_perf, getFullHistoricalData,getHourlyPrice,getFiveDaysPrice} from \"./RestApiCalls\";\nimport constructLatestQuote from \"./ConstructLatestQuote\";\nimport LoadLatestQuote from \"./LoadLatestQuote\";\nimport LoadCompanyProfile from \"./LoadCompanyProfile\";\nimport SectorPerformance from \"./SectorPerformance\";\nimport StockChartBar from \"./StockChartBar\";\nimport LoadStockTable from \"./LoadStockTable\";\n \n//Search Bar (AutoComplete Textbox) with all results.\nclass SearchBar extends Component {\n\n    constructor(property) {\n        super(property);\n        this.state = { suggestions: [], text: '', companyNamesFromJSON: [], company_symbol_json: [], latestQuote: null, \n        companyName: \"\", logo_img: null, quote: null, companyprofile: null, sector_data: null, stockPrice:[], series: [{data:[]}],\n        fiveDayPrice:[] \n    };\n        this.symbol = { value: \"\" };\n        this.getStock_MainFunction = this.getStock_MainFunction.bind(this);\n        this.onCompanyNameChange = this.onCompanyNameChange.bind(this);\n        this.calculateSuggestions = this.calculateSuggestions.bind(this);\n        this.suggestionsSelected = this.suggestionsSelected.bind(this);\n        this.getCompanyNamesForSuggestion = this.getCompanyNamesForSuggestion.bind(this);\n    }\n\n    //On Detecting change in textbox value, populate the company name suggestions\n    //If text is empty, reset the states.\n    onCompanyNameChange = (e) => {\n        const value = e.target.value;\n        if (value.length === 0) {\n            this.setState({ text: '' });\n            this.setState({ suggestions: [] });\n            this.setState({ companyName: '' }, this.getStock_MainFunction);\n        }\n        let suggest = [];\n        if (value.length > 0) {\n            const regex = new RegExp(`^${value}`, 'i');\n            suggest = this.state.companyNamesFromJSON.sort().filter(v => regex.test(v));\n        }\n        this.setState({ suggestions: suggest, text: value });\n\n    }\n\n    //On selecting the company name from the drop down, call the main function: Get Stock\n    suggestionsSelected(value) {\n        this.setState({ text: value });\n        this.setState({ suggestions: [] });\n        this.setState({ companyName: value }, this.getStock_MainFunction);\n    }\n\n    //Renders company name suggestions in a list\n    calculateSuggestions() {\n        const { suggestions } = this.state;\n        if (suggestions.length === 0) {\n            return null;\n        }\n        var i = 0;\n        return (<section role=\"list\" className=\"list-wrapper\">\n            {suggestions.map((item) => <div role=\"listitem\" className=\"list-item\" key={i++} onClick={() => this.suggestionsSelected(item)}>{item}</div>)}\n            </section>)\n    }\n\n    //Given the company name, find the symbol to use in subsequent requests\n    getSymbolFromCompanyName(companyName) {\n        for (var i = 0; i < this.state.company_symbol_json.length; i++) {\n            if (\n                this.state.company_symbol_json[i].name\n                    .toLowerCase()\n                    .includes(companyName.toLowerCase())\n            ) {\n                this.symbol.value = this.state.company_symbol_json[i].symbol;\n                return;\n            }\n        }\n    }\n\n    //Main Function: Get response from all APIS: Latest Quote, Company Profile, Logo\n    getStock_MainFunction() {\n        if (this.state.companyName === undefined || this.state.companyName.length === 0) {\n            this.setState({ latestQuote: null });\n            this.setState({ logo_img: null });\n            this.setState({ quote: null });\n            this.setState({ companyprofile: null });\n            this.setState({stockPrice:null});  \n            this.setState({fiveDayPrice:null}); \n        } else {\n            this.getSymbolFromCompanyName(this.state.companyName);\n            Promise.all([\n                loadLatestQuote(this.symbol.value),\n                getCompanyProfile(this.symbol.value),\n                logo(this.symbol.value),\n                getFullHistoricalData(this.symbol.value),\n                getFiveDaysPrice(this.symbol.value)\n            ]).then((values) => {\n                let quote_data = values[0];\n                this.setState({ latestQuote: constructLatestQuote(quote_data) });\n                this.setState({ logo_img: values[2] });\n                let quote_temp = { ...this.state.latestQuote, logo_img: this.state.logo_img };\n                this.setState({quote: quote_temp });\n                this.setState({companyprofile: values[1]['profile'] });\n                this.setState({stockPrice:values[3]['historical']});\n                this.setState({fiveDayPrice:values[4]});\n                var date = new Date();\n                var startdate = new Date(date.setMonth(date.getMonth()-1));\n                var oneMonthdata=values[3]['historical'].filter(function(obj){\n                var temp = new Date(obj.date); \n                return temp>=startdate;\n                }); \n                this.setState({oneMonthPrice:oneMonthdata});\n                var stockdata=[];\n                oneMonthdata.map(item=>\n                    {\n                        var stockdataArr = [];\n                        stockdataArr.push(item.date,item.open,item.high,item.low,item.close);\n                        stockdata.push(stockdataArr);\n                    });\n                this.setState({ series: [{\n                    data: stockdata}]\n                })\n            });\n        }\n    }\n\n    //Populate all the company Names to use for suggestions later\n    getCompanyNamesForSuggestion() {\n        var data = []\n        for (var i = 0; i < this.state.company_symbol_json.length; i++) {\n            if (this.state.company_symbol_json[i].name.length !== 0) {\n                data.push(this.state.company_symbol_json[i].name);\n            }\n        }\n        this.setState({ companyNamesFromJSON: data });\n    }\n\n    //Executed on load: Symbols and Company mapping data, Sector Performance\n    async componentDidMount() {\n        Promise.all([\n            symbols_company(),\n            sector_perf()\n        ]).then((values) => {\n            this.setState({ company_symbol_json: values[0] }, this.getCompanyNamesForSuggestion);\n            let data_temp = {}\n            data_temp = {\n                basicMaterials: values[1]['sectorPerformance'][0].changesPercentage,\n                CommunicationServices: values[1]['sectorPerformance'][1].changesPercentage,\n                Conglomerates: values[1]['sectorPerformance'][2].changesPercentage,\n                ConsumerCyclical: values[1]['sectorPerformance'][3].changesPercentage,\n                ConsumerDefensive: values[1]['sectorPerformance'][4].changesPercentage,\n                Energy: values[1]['sectorPerformance'][5].changesPercentage,\n                Financial: values[1]['sectorPerformance'][6].changesPercentage,\n                FinancialServices: values[1]['sectorPerformance'][7].changesPercentage,\n                Healthcare: values[1]['sectorPerformance'][8].changesPercentage,\n                IndustrialGoods: values[1]['sectorPerformance'][9].changesPercentage,\n                Industrials: values[1]['sectorPerformance'][10].changesPercentage,\n                RealEstate: values[1]['sectorPerformance'][11].changesPercentage,\n                Services: values[1]['sectorPerformance'][12].changesPercentage,\n                Technology: values[1]['sectorPerformance'][13].changesPercentage,\n                Utilities: values[1]['sectorPerformance'][14].changesPercentage\n            }\n            this.setState({ sector_data: data_temp });\n        });\n    }\n\n    render() {\n        const { text } = this.state;\n        \n        return (\n            <div role=\"main\">\n                <div className=\"AutoComplete\" role=\"search\">\n                    <input value={text} placeholder=\"Enter name of organization\" onChange={this.onCompanyNameChange} type=\"text\" aria-label=\"Select company name\" />\n                    {this.calculateSuggestions()}\n                </div>\n                <div className=\"block_latestquote\" role=\"contentinfo\">\n                    {this.state.quote == null ? (this.state.sector_data == null ? <div className=\"null_condition\" ></div> : <SectorPerformance{...this.state.sector_data} />) : <LoadLatestQuote{...this.state.quote} />}\n                </div>\n                <div className=\"block_latestquote\"  role=\"contentinfo\">\n                    {this.state.companyprofile == null ? <div className=\"null_condition\"></div> : <LoadCompanyProfile{...this.state.companyprofile} />}\n                </div>\n                <div>\n                    {this.state.stockPrice.length == 0 ? <div className=\"null_condition\"></div> : \n                    <StockChartBar stockprice={this.state.stockPrice} series={this.state.series} fiveDayPrice={this.state.fiveDayPrice} oneMonthPrice={this.state.oneMonthPrice}/>}\n                </div>\n                <div>\n                {this.state.stockPrice.length == 0 ? <div className=\"null_condition\"></div> : <LoadStockTable stockprice={this.state.stockPrice}/>}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default SearchBar;\n"]},"metadata":{},"sourceType":"module"}